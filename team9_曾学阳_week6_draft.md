# 第9组_Week6_曾学阳_实车硬件巡检与相机标定任务报告



### 任务 1：Windows 上位机初步检测

#### 1.1 准备工作
在开始操作前，请确保具备以下条件：
*   **硬件需求**：准备一台装有 Windows 系统的笔记本电脑、一根网线。
*   **环境配置**：
    *   **关闭 Windows 防火墙**：确保上位机软件与传感器之间的通信不受阻碍。
    *   **关闭车辆工控机 Ubuntu 系统**：这是关键步骤，必须首先关闭车辆上的工控机，以避免 IP 地址冲突，否则将无法连接激光雷达上位机软件。
*   **设置 Windows 静态 IP**：
    1.  右键点击 Windows 任务栏右下角的网络图标，选择“网络和 Internet 设置”。
    2.  进入网络设置界面，找到并点击“更改适配器选项”或类似入口，进入网络连接列表。
    3.  右键点击当前使用的以太网适配器，选择“属性”。
    4.  在属性窗口中，选择“Internet 协议版本 4 (TCP/IPv4)”，点击“属性”。
    5.  选择“使用下面的 IP 地址”，并严格按照以下数值进行配置：

| 配置项 | 值 | 说明 |
| :--- | :--- | :--- |
| IP 地址 | `192.168.1.102` | 本机 IP 地址，用于与传感器通信 |
| 子网掩码 | `255.255.255.0` | 定义网络范围 |
| 网关 | `192.168.1.1` | 网络出口，通常是路由器或上级设备 |
| 首选 DNS 服务器 | `8.8.8.8` | 谷歌公共 DNS，可选 |
| 备用 DNS 服务器 | (留空或根据需要配置) | |

    6.  点击“确定”保存设置，并确认 IP 地址已成功变更为 `192.168.1.102`。

 ![网络配置图](images/web.png)

#### 1.2 激光雷达 (LiDAR) 检测
*   **目标**：通过 LSLIDAR 上位机软件，检查激光雷达的点云数据质量与覆盖范围。
*   **操作步骤**：
    1.  **物理连接**：使用网线将 Windows 笔记本电脑与激光雷达的网线接口直接连接。
    2.  **启动上位机**：确保车辆工控机处于关机状态，打开 LSLIDAR 上位机软件。
    3.  **建立连接**：点击上位机界面左上角的“连接”图标。
    4.  **点云观察**：连接成功后，观察实时点云画面。
        *   若无法看到画面，可尝试滚动鼠标滚轮缩小画面，调整视角。
        *   使用鼠标拖动或调整角度，检查点云的完整性。
*   **预期结果与验证标准**：
    *   **点云覆盖**：实时点云应能覆盖 360° 环境，无明显盲区或扇区缺失。
    *   **画面稳定性**：点云画面应稳定流畅，无卡顿、闪烁或数据跳变现象。
    *   **数据质量**：点云应能清晰呈现周围环境的几何特征，无大量噪声点。
*   **实验现象记录**：
    *   实际点云覆盖情况：[请在此处填写实际观察到的点云覆盖范围，例如“360°无死角”或“部分区域存在缺失”]
    *   画面稳定性：[请在此处填写实际观察到的画面稳定性，例如“稳定流畅”或“偶有卡顿”]
*   **结果截图**：
    ![激光雷达点云实时画面](images/lidar_pointcloud.png)
    *   **说明**：通过 LSLIDAR 上位机软件检测，激光雷达点云数据刷新正常，能够清晰识别周围障碍物轮廓，数据流稳定，符合预期。**注意：查看完毕后关闭软件即可，严禁对上位机软件做任何数据修改。**

#### 1.3 双目相机 (Camera) 检测
*   **目标**：通过 FieldHelper 工具，检查双目相机的左右目视野是否正常，以及图像实时性。
*   **前提条件**：需在激光雷达上位机软件能正常使用的前提下进行，且完成激光雷达检测后，需要**整车断电再重新上电**进行后续操作，否则 CAN 卡可能无法完全启动。
*   **操作步骤**：
    1.  **启动上位机**：打开 FieldHelper 工具。
    2.  **登录与连接**：选择“离线登录”，然后点击“连接设备”。
    3.  **IP 配置**：在连接界面点击“输入连接设备的 IP 地址”，确认地址为 `192.168.1.251`。
    4.  **自动跳转**：连接成功后，系统将自动跳转至相机视图界面。
*   **预期结果与验证标准**：
    *   **视野正常**：确认左/右目视野均能正常显示，无黑屏、花屏或画面缺失。
    *   **实时性**：图像画面应实时流畅，无明显卡顿或延迟现象。
    *   **图像质量**：图像清晰，色彩正常，无明显噪点或畸变。
*   **实验现象记录**：
    *   左右目视野情况：[请在此处填写实际观察到的左右目视野情况，例如“均正常显示”或“左目有黑屏”]
    *   图像实时性：[请在此处填写实际观察到的图像实时性，例如“实时流畅”或“有明显延迟”]
*   **结果截图**：
    ![FieldHelper 相机左右目视野](images/camera_fieldhelper.png)
    *   **说明**：通过 FieldHelper 工具检测，双目相机画面输出正常，左右目同步性良好，图像清晰，实时性满足要求。

#### 1.4 双目相机标定操作 (仅作说明，非必要不执行)
*   **目标**：理解双目相机内参及安装参数对感知的影响，并了解标准标定流程。
*   **操作步骤**：
    1.  **初始化**：如果相机此前已标定过，需先点击“恢复出厂设置”并等待完成。
    2.  **安装设备**：点击“安装设备”按钮进入配置流程。
    3.  **相机确认**：确认相机画面视野正常。
    4.  **配置参数**：
        *   按照提示完成通讯配置。
        *   输入相机安装位置参数（如离地高度、距保险杠距离等）并点击“保存并下一步”。
    5.  **姿态学习与校正**：选择学习方式，进行相机校正与姿态学习。
    6.  **姿态学习**：选择视差学习，点击开始学习。
    7.  **预警设置**：直接点击“保存并下一步”。
    8.  **同步设置**：直接点击“同步设置”，不需要修改。
    9.  **完成同步**：系统提示配置成功后，设备将自动重启。
*   **结果**：安装标定工作完成。设备状态应显示为“已安装”。
*   **提示**：此标定过程仅作说明，非必要情况下无需重新标定。

### 任务 2：全传感器健康度巡检

#### 2.1 宿主机（Docker 外）底层通讯巡检
*   **目标**：在 Ubuntu 宿主机终端验证底层硬件链路的 CAN 总线通信和网络连通性。

##### 2.1.1 CAN 总线检测
*   **原理说明**：CAN (Controller Area Network) 总线是车辆内部广泛使用的串行通信网络，用于连接各种 ECU（电子控制单元）和传感器。通过 `candump` 命令可以实时抓取 CAN 总线上的报文，验证 CAN 通信是否正常工作。
*   **操作步骤**：
    1.  打开 Ubuntu 宿主机终端。
    2.  执行命令：`candump can0`
*   **预期结果与验证标准**：
    *   **持续数据帧**：终端应有持续跳动的数据帧输出，表明 CAN 总线正在活跃通信。
    *   **多样性**：输出数据帧中应包含两种以上不同的 CAN ID，这表示有多个设备在 CAN 总线上发送数据，而非单一设备循环发送。
*   **实验现象记录**：
    *   数据帧跳动情况：[请在此处填写实际观察到的数据帧跳动情况，例如“持续跳动”或“无数据输出”]
    *   CAN ID 种类：[请在此处填写实际观察到的 CAN ID 种类数量，例如“3种不同 CAN ID”]
*   **结果截图**：
  
    *   **说明**：`candump can0` 命令执行结果显示 CAN 总线通信正常，数据帧持续刷新，且包含多种 CAN ID，证明底盘反馈与传感器数据已通过 CAN 总线正常传输至工控机。

##### 2.1.2 网络连通性检测
*   **原理说明**：`ping` 命令通过发送 ICMP 回显请求包来测试网络上主机的可达性。在自动驾驶系统中，激光雷达和双目相机通常通过以太网与工控机连接，`ping` 命令可以快速验证这些设备的网络连通性及延迟。
*   **操作步骤**：
    1.  打开 Ubuntu 宿主机终端。
    2.  执行以下命令，分别测试激光雷达和双目相机的网络连通性：
        *   激光雷达：`ping 192.168.1.200`
        *   双目相机：`ping 192.168.1.251`
*   **预期结果与验证标准**：
    *   **数据包响应**：`ping` 命令应显示收到数据包，且无丢包现象。
    *   **低延迟**：响应时间（time=）应较低，通常在 1ms 左右，表明网络连接质量良好。
*   **实验现象记录**：
    *   激光雷达 Ping 结果：[请在此处填写实际 Ping 结果，例如“4 packets transmitted, 4 received, 0% packet loss, time 3ms”]
    *   双目相机 Ping 结果：[请在此处填写实际 Ping 结果，例如“4 packets transmitted, 4 received, 0% packet loss, time 2ms”]
*   **结果截图**：
   
    *   **说明**：对激光雷达 (`192.168.1.200`) 和双目相机 (`192.168.1.251`) 的 `ping` 测试均显示网络连接正常，数据包无丢失，延迟极低，证明车载以太网链路畅通。

#### 2.2 Apollo 系统（Docker 内）模块与通道校验
*   **目标**：进入 Apollo Docker 环境，验证核心模块的启动状态以及多源传感器数据流的频率和内容。
*   **进入 Docker 环境**：
    1.  打开 Ubuntu 宿主机终端。
    2.  导航至 Apollo 根目录（例如 `/apollo`）。
    3.  执行命令进入 Docker 环境：`/apollo/docker/scripts/dev_into.sh`

##### 2.2.1 模块启动与状态检查
*   **原理说明**：Apollo Dreamview 是一个基于 Web 的可视化工具，用于监控和控制 Apollo 系统的各个模块。通过 Dreamview 可以直观地查看传感器驱动、定位、规划等模块的运行状态。
*   **操作步骤**：
    1.  在 Docker 环境中，启动 Dreamview（通常通过 `bootstrap.sh` 脚本）。
    2.  在浏览器中访问 Dreamview 界面（通常是 `localhost:8888`）。
    3.  在 Dreamview 的模块控制页面，依次打开以下核心模块：
        *   GPS
        *   IMU
        *   定位 (Localization)
        *   CAN总线 (CANBus)
        *   激光雷达 (LiDAR)
        *   相机 (Camera)
        *   超声波 (Ultrasonic)
        *   毫米波 (Radar)
*   **预期结果与验证标准**：
    *   **模块状态**：所有被打开的模块在 Dreamview 界面中应显示为绿色（正常运行）状态。
    *   **无报错**：控制台或 Dreamview 界面不应出现任何错误或警告信息。
*   **实验现象记录**：
    *   Dreamview 模块状态：[请在此处填写实际观察到的模块状态，例如“所有模块均显示绿色”或“某个模块显示红色报错”]
*   **结果截图**：
  
    *   **说明**：通过 Dreamview 界面检查，所有核心传感器驱动及定位模块均已成功启动并正常运行，状态显示为绿色，无异常报错。

##### 2.2.2 数据通道频率校验 (`rostopic hz`)
*   **原理说明**：ROS (Robot Operating System) 中的 `rostopic hz` 命令用于监控指定 ROS Topic 的发布频率。在自动驾驶系统中，传感器数据流的频率稳定性对感知和决策至关重要。通过此命令可以验证传感器数据是否以预期的频率发布。
*   **操作步骤**：
    1.  确保已在 Docker 环境中。
    2.  打开新的终端窗口（或在当前终端中按 `Ctrl+Shift+T` 新建标签页，并再次进入 Docker）。
    3.  执行以下命令，分别检查各传感器数据通道的发布频率：
        *   激光雷达：`rostopic hz /apollo/sensor/lidar16/PointCloud2`
        *   双目相机：`rostopic hz /apollo/sensor/camera/obstacle/front_6mm`
*   **预期结果与验证标准**：
    *   **激光雷达**：`/apollo/sensor/lidar16/PointCloud2` 的发布频率应稳定在 `~10Hz` 左右。
    *   **双目相机**：`/apollo/sensor/camera/obstacle/front_6mm` 应显示为稳定的数据流，频率通常在 `15Hz` 或 `30Hz` 左右，具体取决于相机配置。
*   **实验现象记录**：
    *   激光雷达实际频率：[请在此处填写实际观察到的激光雷达 Topic 频率，例如“10.1 Hz”]
    *   双目相机实际频率：[请在此处填写实际观察到的双目相机 Topic 频率，例如“15.3 Hz”]
*   **校验结果统计表**：

| 传感器类型 | 通道名称 (Topic) | 目标频率 | 实际频率 | 状态 |
| :--- | :--- | :--- | :--- | :--- |
| 激光雷达 | `/apollo/sensor/lidar16/PointCloud2` | ~10Hz | [填写实际频率] | [正常/异常] |
| 双目相机 | `/apollo/sensor/camera/obstacle/front_6mm` | 稳定流 | [填写实际频率] | [正常/异常] |

*   **结果截图**：

    *   **说明**：`rostopic hz` 命令结果显示，激光雷达和双目相机的数据流发布频率均符合预期，数据传输稳定，无明显波动或中断。

##### 2.2.3 详细数据内容检查 (`rostopic echo`)
*   **原理说明**：`rostopic echo` 命令用于实时显示指定 ROS Topic 上发布的消息内容。通过检查原始数据字段，可以验证传感器数据是否正确解析、是否包含有效信息，以及底盘反馈等关键数据是否与实车状态同步。
*   **操作步骤**：
    1.  确保已在 Docker 环境中。
    2.  打开新的终端窗口（或在当前终端中按 `Ctrl+Shift+T` 新建标签页，并再次进入 Docker）。
    3.  执行以下命令，分别检查各传感器数据通道的详细内容：
        *   超声波雷达：`rostopic echo /apollo/sensor/ultrasonic_radar`
        *   毫米波雷达：`rostopic echo /apollo/sensor/conti_radar`
        *   组合导航：`rostopic echo /apollo/sensor/gnss/best_pose`
        *   惯导：`rostopic echo /apollo/sensor/gnss/imu`
        *   底盘反馈：`rostopic echo /apollo/canbus/chassis`
        *   定位结果：`rostopic echo /apollo/localization/pose`
*   **预期结果与验证标准**：
    *   **超声波雷达 (`/apollo/sensor/ultrasonic_radar`)**：应确认有 8-12 路测距数值输出，且数值随环境变化而更新。
    *   **毫米波雷达 (`/apollo/sensor/conti_radar`)**：应能检测并回传障碍物信息，包括障碍物 ID、距离、速度等字段，且数据持续刷新。
    *   **组合导航 (`/apollo/sensor/gnss/best_pose`)**：应输出包含经纬度、高程、定位模式等信息的 GNSS 定位结果，且数据持续刷新。
    *   **惯导 (`/apollo/sensor/gnss/imu`)**：应输出三轴加速度（`linear_acceleration`）与角速度（`angular_velocity`）数据，且数值持续刷新，反映车辆姿态变化。
    *   **底盘反馈 (`/apollo/canbus/chassis`)**：应输出车速（`speed_mps`）、转向角（`steering_percentage`）等信息，且这些信息应与实车状态（如车辆静止时速度为 0）同步。
    *   **定位结果 (`/apollo/localization/pose`)**：应输出包含车辆在世界坐标系下的位置（`position`）和姿态（`orientation`）信息，且数据持续刷新。
*   **实验现象记录**：
    *   超声波雷达数据：[请在此处填写实际观察到的超声波雷达数据特点，例如“10路测距数据，数值随障碍物距离变化”]
    *   毫米波雷达数据：[请在此处填写实际观察到的毫米波雷达数据特点，例如“检测到多个障碍物，包含ID、距离、速度信息”]
    *   组合导航数据：[请在此处填写实际观察到的组合导航数据特点，例如“经纬度、高程数据持续更新，定位模式为RTK Fixed”]
    *   惯导数据：[请在此处填写实际观察到的惯导数据特点，例如“三轴加速度和角速度数据持续刷新，反映车辆微小姿态变化”]
    *   底盘反馈数据：[请在此处填写实际观察到的底盘反馈数据特点，例如“车速为0，转向角为0，与车辆静止状态一致”]
    *   定位结果数据：[请在此处填写实际观察到的定位结果数据特点，例如“车辆位置和姿态数据持续更新，与Dreamview显示一致”]
*   **结果截图**：

    *   **说明**：通过 `rostopic echo` 命令对各传感器数据流进行详细检查，确认超声波、毫米波、GNSS、IMU、CANBus 和定位结果等 Topic 均能正常发布有效数据，数据字段完整，且与预期功能相符。



## 五、 总结与展望
本次实训任务全面检验了自动驾驶实车的硬件底层通信链路和 Apollo 系统的数据流完整性。从 Windows 上位机对激光雷达和双目相机的初步检测，到 Ubuntu 宿主机下的 CAN 总线与网络连通性验证，再到 Apollo Docker 环境中各模块的启动状态、ROS Topic 频率及详细数据内容的校验，所有环节均按照标准流程进行。结果表明，车辆的硬件系统运行稳定，传感器数据流健康，Apollo 核心模块协同工作正常，为后续更高级别的感知、规划与控制算法开发奠定了坚实可靠的基础。未来可在此基础上进一步开展传感器融合、高精地图构建与定位等进阶任务。
